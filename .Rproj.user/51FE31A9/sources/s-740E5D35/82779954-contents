language: r
pandoc_version: 2.3.1

before_install:
  - sudo apt-get update
  - sudo apt-get install python3


script:
  - Rscript -e 'remotes::install_github("RLesur/klippy")'
  - Rscript -e 'remotes::install_github("juba/rmdformats")'
  - Rscript -e 'print(Sys.which("python3"))'
  - Rscript -e 'bookdown::render_book("index.Rmd", output_format = "rmdformats::readthedown")'
  - mkdir docs; mv out.html docs

cache:
  packages: yes
  directories:

deploy:
  provider: pages
  skip-cleanup: true
  github-token: $GH_TOKEN  # Set in travis-ci.org dashboard, marked secure
  keep-history: true
  local-dir: docs # Book output directory
  on:
    branch: master
